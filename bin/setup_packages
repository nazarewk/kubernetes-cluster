#!/bin/sh
cd $(dirname "$(readlink -f "$0")")/..

find_virtualenv() {
    which virtualenv 2> /dev/null || which virtualenv
}

create_env () {
    local cmd=$(find_virtualenv)
    [ -z "$cmd" ] && sudo pip install virtualenv && cmd=$(find_virtualenv)
    [ -z "$cmd" ] && echo "virtualenv is missing" && exit 1

    ${cmd} -p $(which python) .env
    . .env/bin/activate

    pip install -U pip setuptools
}

[ -z "$(which python)" ] && echo 'python is missing' && exit 1

[ -e .env/bin/activate ] && . .env/bin/activate || create_env

pip install -U -r requirements.txt
